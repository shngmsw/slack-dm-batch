# Slack一括DM送信システム 要件定義

## 1. 概要
Slackで同一の内容のダイレクトメッセージを複数のユーザーに一括送信するPythonシステムを構築する。
直感的で使いやすいWeb UIを提供し、技術者以外でも簡単に操作できるようにする。

## 2. 機能要件

### 2.1 基本機能
- 複数のSlackユーザーに同じメッセージをDMで送信
- 埋め込み変数を使用したパーソナライズされたメッセージ作成
- 送信対象ユーザーリストの可変対応
- 送信内容の可変対応

### 2.2 認証機能
- User Auth Tokenを使用したSlack API認証
- トークンの安全な管理
- Web UI上でのトークン入力・保存機能

### 2.3 メッセージテンプレート機能
- 変数埋め込み対応（例：{name}、{company}など）
- テンプレート文字列とデータの分離
- Web UI上でのリアルタイムプレビュー

### 2.4 送信対象管理
- ユーザーIDまたはユーザー名による送信対象指定
- CSVファイルやJSONファイルからの送信対象読み込み
- Web UI上での手動入力・編集機能
- ドラッグ&ドロップファイルアップロード
- Slackメンションリストの直接コピペ対応（例：@Misawa.もせ @田中太郎）
- メンション形式からユーザー情報への自動変換

### 2.5 Web UI機能
- メッセージテンプレート入力フォーム
- 送信対象ユーザー管理インターフェース
- リアルタイムメッセージプレビュー
- 送信進捗表示
- 送信結果一覧表示
- エラー詳細表示
- メンションリストの貼り付けエリア
- ユーザー名の自動解析・表示機能

## 3. 非機能要件

### 3.1 セキュリティ
- APIトークンの環境変数管理
- レート制限の遵守
- エラーハンドリング
- Web UI上でのCSRF対策
- トークンの安全な入力・保存

### 3.2 使いやすさ
- 直感的なWeb UI設計
- レスポンシブデザイン
- コマンドライン引数での操作（CLI併用）
- 設定ファイルによる管理
- 送信前のプレビュー機能

### 3.3 信頼性
- 送信失敗時のリトライ機能
- 送信結果のログ出力
- エラー発生時の適切な処理
- Web UI上でのリアルタイム状態表示

## 4. 技術要件
- Python 3.8以上
- slack-sdk ライブラリの使用
- User Auth Token（xoxp-）の使用
- Web フレームワーク（Flask または FastAPI）
- フロントエンド技術（HTML, CSS, JavaScript）

## 5. 制約条件
- Slack API のレート制限遵守
- User Auth Tokenの適切な権限設定が必要
- 送信対象ユーザーがワークスペース内に存在する必要
- ローカル環境での動作を前提

## 6. 成功基準
- 指定した複数ユーザーに正常にDMが送信される
- 変数埋め込みが正しく動作する
- エラーが適切にハンドリングされる
- 送信結果が適切にログ出力される
- Web UIが直感的で使いやすい
- 技術者以外でも操作可能
- Slackからコピーしたメンションリストが正しく解析される
- 日本語を含むユーザー名が適切に処理される